<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Previdência - Dr. Reginaldo Oliveira</title>
    <meta name="description" content="Calculadora previdenciária completa para simular aposentadorias e benefícios do INSS. Simule sua aposentadoria por idade, tempo de contribuição e outros benefícios.">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>⚖️</text></svg>">
    
    <!-- Meta Tags para SEO -->
    <meta name="keywords" content="calculadora previdenciária, aposentadoria, INSS, tempo de contribuição, benefício previdenciário, simulador aposentadoria">
    <meta name="author" content="Dr. Reginaldo Oliveira">
    <meta name="robots" content="index, follow">
    
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header - Mantendo a mesma estrutura da página inicial -->
    <header class="header">
        <nav class="nav container">
            <a href="index.html" class="nav__logo">
                <div class="logo-container">
                    <div class="logo-icon">
                        <i class="fas fa-balance-scale"></i>
                    </div>
                    <div class="logo-text">
                        <span>Dr. Reginaldo Oliveira</span>
                        <small>OAB/SC 57.879</small>
                    </div>
                </div>
            </a>
            
            <div class="nav__menu" id="nav-menu">
                <ul class="nav__list">
                    <li class="nav__item">
                        <a href="index.html" class="nav__link">Início</a>
                    </li>
                    <li class="nav__item">
                        <a href="index.html#sobre" class="nav__link">Sobre</a>
                    </li>
                    <li class="nav__item">
                        <a href="index.html#atuacao" class="nav__link">Atuação</a>
                    </li>
                    <li class="nav__item">
                        <a href="calculadora.html" class="nav__link active">Calculadora</a>
                    </li>
                    <li class="nav__item">
                        <a href="index.html#diferenciais" class="nav__link">Diferenciais</a>
                    </li>
                    <li class="nav__item">
                        <a href="blog.html" class="nav__link">Artigos</a>
                    </li>
                    <li class="nav__item">
                        <a href="index.html#contato" class="nav__link">Contato</a>
                    </li>
                </ul>
                
                <div class="nav__close" id="nav-close">
                    <i class="fas fa-times"></i>
                </div>
            </div>
            
            <div class="nav__toggle" id="nav-toggle">
                <i class="fas fa-bars"></i>
            </div>
        </nav>
    </header>

    <!-- Calculator Hero -->
    <section class="calculator-hero">
        <div class="container">
            <h1 class="calculator-hero__title">Calculadora de Previdência</h1>
            <p class="calculator-hero__subtitle">Simule seus benefícios previdenciários</p>
            <p class="calculator-hero__description">
                Descubra quando e como você pode se aposentar ou receber benefícios do INSS com base nas regras atuais da previdência.
            </p>
            <div class="calculator-hero__features">
                <div class="feature">
                    <i class="fas fa-shield-alt"></i>
                    <span>Simulação 100% segura</span>
                </div>
                <div class="feature">
                    <i class="fas fa-clock"></i>
                    <span>Resultados instantâneos</span>
                </div>
                <div class="feature">
                    <i class="fas fa-user-tie"></i>
                    <span>Baseado nas regras atuais</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Calculator Disclaimer -->
    <section class="calculator-disclaimer">
        <div class="container">
            <div class="disclaimer-content">
                <i class="fas fa-exclamation-triangle"></i>
                <div>
                    <h3>Atenção</h3>
                    <p>Esta calculadora fornece uma estimativa com base nas regras atuais da previdência. Os resultados são meramente informativos e não substituem a consulta com um especialista.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Calculator Main -->
    <section class="calculator-main">
        <div class="container">
            <div class="calculator-container">
                <div class="calculator-steps">
                    <div class="step active" data-step="1">
                        <div class="step-number">1</div>
                        <div class="step-text">Tipo de Benefício</div>
                    </div>
                    <div class="step" data-step="2">
                        <div class="step-number">2</div>
                        <div class="step-text">Dados Pessoais</div>
                    </div>
                    <div class="step" data-step="3">
                        <div class="step-number">3</div>
                        <div class="step-text">Informações Profissionais</div>
                    </div>
                    <div class="step" data-step="4">
                        <div class="step-number">4</div>
                        <div class="step-text">Resultado</div>
                    </div>
                </div>

                <form id="calculatorForm" class="calculator-form">
                    <!-- Step 1 - Seleção do Tipo de Benefício -->
                    <div class="form-step active" data-step="1">
                        <h3 class="form-step__title">Qual benefício você gostaria de simular?</h3>
                        <div class="benefit-selection">
                            <div class="benefit-options">
                                <div class="benefit-option" data-benefit="age">
                                    <div class="benefit-icon">
                                        <i class="fas fa-user-clock"></i>
                                    </div>
                                    <h4>Aposentadoria por Idade</h4>
                                    <p>Simule sua aposentadoria com base na sua idade</p>
                                </div>
                                <div class="benefit-option" data-benefit="contribution">
                                    <div class="benefit-icon">
                                        <i class="fas fa-hourglass-half"></i>
                                    </div>
                                    <h4>Aposentadoria por Tempo de Contribuição</h4>
                                    <p>Calcule com base no seu tempo de contribuição</p>
                                </div>
                                <div class="benefit-option" data-benefit="disability">
                                    <div class="benefit-icon">
                                        <i class="fas fa-heartbeat"></i>
                                    </div>
                                    <h4>Auxílio-Doença</h4>
                                    <p>Simule o benefício por incapacidade temporária</p>
                                </div>
                                <div class="benefit-option" data-benefit="pension">
                                    <div class="benefit-icon">
                                        <i class="fas fa-users"></i>
                                    </div>
                                    <h4>Pensão por Morte</h4>
                                    <p>Calcule o valor da pensão para dependentes</p>
                                </div>
                                <div class="benefit-option" data-benefit="bpc">
                                    <div class="benefit-icon">
                                        <i class="fas fa-wheelchair"></i>
                                    </div>
                                    <h4>BPC/LOAS</h4>
                                    <p>Benefício de Prestação Continuada</p>
                                </div>
                                <div class="benefit-option" data-benefit="special">
                                    <div class="benefit-icon">
                                        <i class="fas fa-hard-hat"></i>
                                    </div>
                                    <h4>Aposentadoria Especial</h4>
                                    <p>Para atividades insalubres ou perigosas</p>
                                </div>
                            </div>
                        </div>
                        <div class="form-actions">
                            <div></div>
                            <button type="button" class="button button--primary next-step" data-next="2" disabled id="nextStep1">
                                Próximo
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Step 2 - Dados Pessoais -->
                    <div class="form-step" data-step="2">
                        <h3 class="form-step__title">Dados Pessoais</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="birthDate">Data de Nascimento *</label>
                                <input type="date" id="birthDate" name="birthDate" required>
                            </div>
                            <div class="form-group">
                                <label for="gender">Gênero *</label>
                                <select id="gender" name="gender" required>
                                    <option value="">Selecione</option>
                                    <option value="male">Masculino</option>
                                    <option value="female">Feminino</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="maritalStatus">Estado Civil</label>
                            <select id="maritalStatus" name="maritalStatus">
                                <option value="">Selecione</option>
                                <option value="single">Solteiro(a)</option>
                                <option value="married">Casado(a)</option>
                                <option value="divorced">Divorciado(a)</option>
                                <option value="widowed">Viúvo(a)</option>
                            </select>
                        </div>
                        <div class="form-group" id="dependentsGroup" style="display: none;">
                            <label for="dependents">Número de Dependentes</label>
                            <input type="number" id="dependents" name="dependents" min="0" max="10" value="0">
                        </div>
                        <div class="form-actions">
                            <button type="button" class="button button--secondary prev-step" data-prev="1">
                                <i class="fas fa-arrow-left"></i>
                                Anterior
                            </button>
                            <button type="button" class="button button--primary next-step" data-next="3">
                                Próximo
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Step 3 - Informações Profissionais -->
                    <div class="form-step" data-step="3">
                        <h3 class="form-step__title">Informações Profissionais</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="startWork">Data de Início da Contribuição *</label>
                                <input type="date" id="startWork" name="startWork" required>
                            </div>
                            <div class="form-group">
                                <label for="salary">Salário Base (R$) *</label>
                                <input type="number" id="salary" name="salary" min="1300" max="7500" step="0.01" placeholder="Ex: 3000,00" required>
                                <small>Informe um valor entre R$ 1.300,00 e R$ 7.500,00</small>
                            </div>
                        </div>
                        <div class="form-group" id="specialPeriodsGroup" style="display: none;">
                            <label>Períodos Especiais</label>
                            <div class="checkbox-group">
                                <label class="checkbox">
                                    <input type="checkbox" name="ruralPeriod">
                                    <span class="checkmark"></span>
                                    Atividade Rural
                                </label>
                                <label class="checkbox">
                                    <input type="checkbox" name="hazardousPeriod">
                                    <span class="checkmark"></span>
                                    Atividade de Risco
                                </label>
                                <label class="checkbox">
                                    <input type="checkbox" name="teacherPeriod">
                                    <span class="checkmark"></span>
                                    Professor
                                </label>
                            </div>
                        </div>
                        <div class="form-group" id="disabilityInfoGroup" style="display: none;">
                            <label for="disabilityStart">Data de Início da Incapacidade</label>
                            <input type="date" id="disabilityStart" name="disabilityStart">
                        </div>
                        <div class="form-group" id="pensionInfoGroup" style="display: none;">
                            <label for="deceasedSalary">Salário do Falecido (R$)</label>
                            <input type="number" id="deceasedSalary" name="deceasedSalary" min="1300" max="7500" step="0.01" placeholder="Ex: 3000,00">
                        </div>
                        <div class="form-group" id="bpcInfoGroup" style="display: none;">
                            <label for="familyIncome">Renda Familiar Mensal (R$)</label>
                            <input type="number" id="familyIncome" name="familyIncome" min="0" step="0.01" placeholder="Ex: 1500,00">
                        </div>
                        <div class="form-actions">
                            <button type="button" class="button button--secondary prev-step" data-prev="2">
                                <i class="fas fa-arrow-left"></i>
                                Anterior
                            </button>
                            <button type="button" class="button button--primary calculate-btn">
                                Calcular
                                <i class="fas fa-calculator"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Step 4 - Resultado -->
                    <div class="form-step" data-step="4">
                        <h3 class="form-step__title">Resultado da Simulação</h3>
                        
                        <div class="results-container">
                            <div class="result-card highlight">
                                <div class="result-icon">
                                    <i class="fas fa-calendar-alt"></i>
                                </div>
                                <div class="result-content">
                                    <h4>Idade para Aposentadoria</h4>
                                    <div class="result-value" id="resultAge">--</div>
                                </div>
                            </div>
                            <div class="result-card">
                                <div class="result-icon">
                                    <i class="fas fa-hourglass-half"></i>
                                </div>
                                <div class="result-content">
                                    <h4>Tempo Restante</h4>
                                    <div class="result-value" id="resultTimeLeft">--</div>
                                </div>
                            </div>
                            <div class="result-card">
                                <div class="result-icon">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <div class="result-content">
                                    <h4>Valor Estimado</h4>
                                    <div class="result-value" id="resultValue">--</div>
                                </div>
                            </div>
                        </div>

                        <div class="result-details">
                            <h4>Detalhes da Simulação</h4>
                            <div class="details-grid">
                                <div class="detail-item">
                                    <span>Benefício:</span>
                                    <strong id="detailBenefit">--</strong>
                                </div>
                                <div class="detail-item">
                                    <span>Regra Aplicada:</span>
                                    <strong id="detailRule">--</strong>
                                </div>
                                <div class="detail-item">
                                    <span>Idade Atual:</span>
                                    <strong id="detailCurrentAge">--</strong>
                                </div>
                                <div class="detail-item">
                                    <span>Tempo Contribuído:</span>
                                    <strong id="detailContributedTime">--</strong>
                                </div>
                                <div class="detail-item">
                                    <span>Salário Base:</span>
                                    <strong id="detailBaseSalary">--</strong>
                                </div>
                                <div class="detail-item" id="detailDependentsItem" style="display: none;">
                                    <span>Dependentes:</span>
                                    <strong id="detailDependents">--</strong>
                                </div>
                            </div>
                        </div>

                        <div class="result-cta">
                            <div class="cta-content">
                                <h4>Precisa de ajuda especializada?</h4>
                                <p>Nossos especialistas em previdência podem te ajudar a entender melhor suas opções e planejar sua aposentadoria.</p>
                                <div class="cta-buttons">
                                    <a href="https://wa.me/5571996510966?text=Olá,%20gostaria%20de%20agendar%20uma%20consulta%20sobre%20minha%20aposentadoria" class="button button--secondary" target="_blank">
                                        <i class="fas fa-whatsapp"></i>
                                        Falar no WhatsApp
                                    </a>
                                    <a href="index.html#contato" class="button button--primary">
                                        <i class="fas fa-phone-alt"></i>
                                        Agendar Consulta
                                    </a>
                                </div>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="button button--secondary prev-step" data-prev="3">
                                <i class="fas fa-arrow-left"></i>
                                Voltar
                            </button>
                            <button type="button" class="button button--primary new-calculation">
                                <i class="fas fa-redo"></i>
                                Nova Simulação
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section class="calculator-faq">
        <div class="container">
            <h2 class="section__title">Perguntas Frequentes</h2>
            <div class="faq-grid">
                <div class="faq-item">
                    <h3>Como a calculadora funciona?</h3>
                    <p>A calculadora simula seu benefício previdenciário com base nas regras atuais da previdência, considerando seus dados pessoais e profissionais.</p>
                </div>
                <div class="faq-item">
                    <h3>Os resultados são precisos?</h3>
                    <p>Os resultados são estimativas baseadas nas regras atuais. Para uma análise precisa, consulte um especialista em direito previdenciário.</p>
                </div>
                <div class="faq-item">
                    <h3>Quais benefícios posso simular?</h3>
                    <p>A calculadora permite simular aposentadoria por idade, tempo de contribuição, auxílio-doença, pensão por morte, BPC/LOAS e aposentadoria especial.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer - Mantendo a mesma estrutura da página inicial -->
    <footer class="footer">
        <div class="footer__container container grid">
            <div class="footer__content">
                <a href="index.html" class="footer__logo">
                    <div class="logo-container">
                        <div class="logo-icon">
                            <i class="fas fa-balance-scale"></i>
                        </div>
                        <div class="logo-text">
                            <span>Dr. Reginaldo Oliveira</span>
                        </div>
                    </div>
                </a>
                <p class="footer__description">
                    Advogado especialista em Direito Previdenciário. 
                    Defendendo seus direitos com excelência e compromisso.
                </p>
            </div>
            
            <div class="footer__content">
                <h3 class="footer__title">Navegação</h3>
                <ul class="footer__links">
                    <li><a href="index.html" class="footer__link">Início</a></li>
                    <li><a href="index.html#sobre" class="footer__link">Sobre</a></li>
                    <li><a href="index.html#atuacao" class="footer__link">Atuação</a></li>
                    <li><a href="blog.html" class="footer__link">Artigos</a></li>
                </ul>
            </div>
            
            <div class="footer__content">
                <h3 class="footer__title">Contato</h3>
                <ul class="footer__contact">
                    <li>
                        <i class="fas fa-phone footer__contact-icon"></i>
                        (71) 99651-0966
                    </li>
                    <li>
                        <i class="fas fa-envelope footer__contact-icon"></i>
                        contato@juridicamente.blog
                    </li>
                    <li>
                        <i class="fas fa-map-marker-alt footer__contact-icon"></i>
                        Atendimento em Todo Brasil
                    </li>
                </ul>
            </div>
        </div>
        
        <div class="footer__copy">
            <p>&copy; 2024 Dr. Reginaldo Oliveira - OAB/SC 57.879. Todos os direitos reservados.</p>
        </div>
    </footer>

    <!-- WhatsApp Float -->
    <a href="https://wa.me/5571996510966?text=Olá,%20gostaria%20de%20agendar%20uma%20consulta%20com%20o%20Dr.%20Reginaldo%20Oliveira" class="whatsapp-float" target="_blank" aria-label="Entre em contato pelo WhatsApp">
        <i class="fab fa-whatsapp"></i>
    </a>

    <script>
        // Calculator JavaScript - Versão Completa
        class PrevidenciaCalculator {
            constructor() {
                this.currentStep = 1;
                this.selectedBenefit = null;
                this.formData = {};
                this.init();
            }

            init() {
                this.bindEvents();
                this.showStep(1);
            }

            bindEvents() {
                // Benefit selection
                document.querySelectorAll('.benefit-option').forEach(option => {
                    option.addEventListener('click', (e) => {
                        document.querySelectorAll('.benefit-option').forEach(opt => {
                            opt.classList.remove('selected');
                        });
                        option.classList.add('selected');
                        this.selectedBenefit = option.getAttribute('data-benefit');
                        document.getElementById('nextStep1').disabled = false;
                    });
                });

                // Next step buttons
                document.querySelectorAll('.next-step').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const nextStep = parseInt(e.target.getAttribute('data-next'));
                        if (this.validateStep(this.currentStep)) {
                            this.saveStepData(this.currentStep);
                            this.showStep(nextStep);
                        }
                    });
                });

                // Previous step buttons
                document.querySelectorAll('.prev-step').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const prevStep = parseInt(e.target.getAttribute('data-prev'));
                        this.showStep(prevStep);
                    });
                });

                // Calculate button
                document.querySelector('.calculate-btn').addEventListener('click', () => {
                    if (this.validateStep(3)) {
                        this.saveStepData(3);
                        this.calculate();
                        this.showStep(4);
                    }
                });

                // New calculation button
                document.querySelector('.new-calculation').addEventListener('click', () => {
                    this.resetCalculator();
                });

                // Show/hide fields based on benefit type
                document.getElementById('maritalStatus').addEventListener('change', (e) => {
                    const dependentsGroup = document.getElementById('dependentsGroup');
                    if (e.target.value === 'married' || e.target.value === 'widowed') {
                        dependentsGroup.style.display = 'block';
                    } else {
                        dependentsGroup.style.display = 'none';
                    }
                });

                // Show/hide special fields based on benefit type
                document.addEventListener('change', () => {
                    this.updateFormFields();
                });
            }

            updateFormFields() {
                const specialPeriodsGroup = document.getElementById('specialPeriodsGroup');
                const disabilityInfoGroup = document.getElementById('disabilityInfoGroup');
                const pensionInfoGroup = document.getElementById('pensionInfoGroup');
                const bpcInfoGroup = document.getElementById('bpcInfoGroup');

                // Reset all
                specialPeriodsGroup.style.display = 'none';
                disabilityInfoGroup.style.display = 'none';
                pensionInfoGroup.style.display = 'none';
                bpcInfoGroup.style.display = 'none';

                // Show relevant fields based on selected benefit
                if (this.selectedBenefit === 'special') {
                    specialPeriodsGroup.style.display = 'block';
                } else if (this.selectedBenefit === 'disability') {
                    disabilityInfoGroup.style.display = 'block';
                } else if (this.selectedBenefit === 'pension') {
                    pensionInfoGroup.style.display = 'block';
                } else if (this.selectedBenefit === 'bpc') {
                    bpcInfoGroup.style.display = 'block';
                }
            }

            showStep(step) {
                // Hide all steps
                document.querySelectorAll('.form-step').forEach(step => {
                    step.classList.remove('active');
                });

                // Show current step
                document.querySelector(`.form-step[data-step="${step}"]`).classList.add('active');

                // Update steps indicator
                document.querySelectorAll('.calculator-steps .step').forEach(stepEl => {
                    stepEl.classList.remove('active');
                    if (parseInt(stepEl.getAttribute('data-step')) <= step) {
                        stepEl.classList.add('active');
                    }
                });

                this.currentStep = step;
            }

            validateStep(step) {
                const currentStepEl = document.querySelector(`.form-step[data-step="${step}"]`);
                const inputs = currentStepEl.querySelectorAll('input[required], select[required]');
                
                let isValid = true;

                // For step 1, we need to check if a benefit was selected
                if (step === 1) {
                    if (!this.selectedBenefit) {
                        this.showError('Selecione um tipo de benefício para continuar');
                        isValid = false;
                    }
                }

                inputs.forEach(input => {
                    if (!input.value) {
                        input.classList.add('error');
                        isValid = false;
                    } else {
                        input.classList.remove('error');
                    }
                });

                // Additional validations for step 2
                if (step === 2) {
                    const birthDate = new Date(document.getElementById('birthDate').value);
                    const today = new Date();

                    if (birthDate >= today) {
                        this.showError('Data de nascimento não pode ser futura');
                        isValid = false;
                    }
                }

                // Additional validations for step 3
                if (step === 3) {
                    const birthDate = new Date(document.getElementById('birthDate').value);
                    const startWork = new Date(document.getElementById('startWork').value);
                    const today = new Date();
                    const salary = parseFloat(document.getElementById('salary').value);

                    if (startWork >= today) {
                        this.showError('Data de início não pode ser futura');
                        isValid = false;
                    }

                    if (startWork < birthDate) {
                        this.showError('Data de início não pode ser anterior ao nascimento');
                        isValid = false;
                    }

                    if (salary < 1300 || salary > 7500) {
                        this.showError('Salário deve estar entre R$ 1.300,00 e R$ 7.500,00');
                        isValid = false;
                    }
                }

                if (!isValid) {
                    this.showError('Preencha todos os campos obrigatórios corretamente');
                }

                return isValid;
            }

            showError(message) {
                // Remove existing error messages
                const existingError = document.querySelector('.error-message');
                if (existingError) {
                    existingError.remove();
                }

                // Create error message
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.innerHTML = `
                    <i class="fas fa-exclamation-circle"></i>
                    ${message}
                `;

                // Insert error message
                const currentStep = document.querySelector(`.form-step[data-step="${this.currentStep}"]`);
                currentStep.insertBefore(errorDiv, currentStep.firstChild);

                // Auto remove after 5 seconds
                setTimeout(() => {
                    errorDiv.remove();
                }, 5000);
            }

            saveStepData(step) {
                const stepEl = document.querySelector(`.form-step[data-step="${step}"]`);
                const inputs = stepEl.querySelectorAll('input, select');
                
                inputs.forEach(input => {
                    if (input.type === 'checkbox') {
                        this.formData[input.name] = input.checked;
                    } else {
                        this.formData[input.name] = input.value;
                    }
                });

                // Save selected benefit
                if (step === 1) {
                    this.formData.benefitType = this.selectedBenefit;
                }
            }

            calculate() {
                const birthDate = new Date(this.formData.birthDate);
                const startWork = new Date(this.formData.startWork);
                const salary = parseFloat(this.formData.salary);
                const gender = this.formData.gender;
                const benefitType = this.formData.benefitType;
                const dependents = parseInt(this.formData.dependents) || 0;

                const today = new Date();
                const currentAge = this.calculateAge(birthDate, today);
                const contributedTime = this.calculateTimeDifference(startWork, today);

                let resultAge, resultTimeLeft, resultValue, detailRule, benefitName;

                // Calculate based on benefit type
                switch (benefitType) {
                    case 'age':
                        benefitName = 'Aposentadoria por Idade';
                        resultAge = gender === 'male' ? 65 : 62;
                        resultTimeLeft = Math.max(0, resultAge - currentAge);
                        resultValue = this.calculateAgeRetirementValue(salary, gender);
                        detailRule = 'Idade mínima: ' + (gender === 'male' ? '65 anos' : '62 anos');
                        break;

                    case 'contribution':
                        benefitName = 'Aposentadoria por Tempo de Contribuição';
                        const requiredTime = gender === 'male' ? 35 : 30;
                        resultAge = currentAge + Math.max(0, requiredTime - contributedTime.years);
                        resultTimeLeft = Math.max(0, requiredTime - contributedTime.years);
                        resultValue = this.calculateTimeRetirementValue(salary, contributedTime.years);
                        detailRule = 'Tempo mínimo: ' + requiredTime + ' anos';
                        break;

                    case 'disability':
                        benefitName = 'Auxílio-Doença';
                        resultAge = '-';
                        resultTimeLeft = '-';
                        resultValue = this.calculateDisabilityValue(salary);
                        detailRule = 'Carência de 12 meses e incapacidade comprovada';
                        break;

                    case 'pension':
                        benefitName = 'Pensão por Morte';
                        resultAge = '-';
                        resultTimeLeft = '-';
                        const deceasedSalary = parseFloat(this.formData.deceasedSalary) || salary;
                        resultValue = this.calculatePensionValue(deceasedSalary, dependents);
                        detailRule = 'Baseado no salário do falecido e número de dependentes';
                        break;

                    case 'bpc':
                        benefitName = 'BPC/LOAS';
                        resultAge = '-';
                        resultTimeLeft = '-';
                        resultValue = this.calculateBPCValue();
                        detailRule = 'Renda familiar per capita inferior a 1/4 do salário mínimo';
                        break;

                    case 'special':
                        benefitName = 'Aposentadoria Especial';
                        resultAge = currentAge + Math.max(0, 25 - contributedTime.years);
                        resultTimeLeft = Math.max(0, 25 - contributedTime.years);
                        resultValue = this.calculateSpecialRetirementValue(salary);
                        detailRule = '25 anos de atividade especial';
                        break;
                }

                // Update results in DOM
                this.updateResults({
                    resultAge: resultAge + (resultAge !== '-' ? ' anos' : ''),
                    resultTimeLeft: resultTimeLeft + (resultTimeLeft !== '-' ? ' anos' : ''),
                    resultValue: 'R$ ' + (typeof resultValue === 'number' ? resultValue.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : resultValue),
                    detailBenefit: benefitName,
                    detailRule: detailRule,
                    detailCurrentAge: currentAge + ' anos',
                    detailContributedTime: contributedTime.years + ' anos e ' + contributedTime.months + ' meses',
                    detailBaseSalary: 'R$ ' + salary.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })
                });

                // Show dependents if applicable
                const dependentsItem = document.getElementById('detailDependentsItem');
                if (benefitType === 'pension' && dependents > 0) {
                    document.getElementById('detailDependents').textContent = dependents;
                    dependentsItem.style.display = 'flex';
                } else {
                    dependentsItem.style.display = 'none';
                }
            }

            calculateAge(birthDate, currentDate) {
                let age = currentDate.getFullYear() - birthDate.getFullYear();
                const monthDiff = currentDate.getMonth() - birthDate.getMonth();
                
                if (monthDiff < 0 || (monthDiff === 0 && currentDate.getDate() < birthDate.getDate())) {
                    age--;
                }
                
                return age;
            }

            calculateTimeDifference(startDate, endDate) {
                let years = endDate.getFullYear() - startDate.getFullYear();
                let months = endDate.getMonth() - startDate.getMonth();
                
                if (months < 0) {
                    years--;
                    months += 12;
                }
                
                return { years, months };
            }

            calculateAgeRetirementValue(salary, gender) {
                // 70% do salário de benefício + 1% por ano de contribuição acima de 15 anos (mulheres) ou 20 anos (homens)
                const baseYears = gender === 'male' ? 20 : 15;
                let percentage = 0.7;
                
                const contributedYears = this.calculateTimeDifference(new Date(this.formData.startWork), new Date()).years;
                if (contributedYears > baseYears) {
                    percentage += (contributedYears - baseYears) * 0.01;
                }
                
                percentage = Math.min(percentage, 1.0); // Cap at 100%
                
                return Math.min(salary * percentage, 7500); // Cap at maximum benefit
            }

            calculateTimeRetirementValue(salary, contributedYears) {
                // 60% + 2% por ano acima de 15 anos (mulheres) ou 20 anos (homens)
                const baseYears = this.formData.gender === 'male' ? 20 : 15;
                let percentage = 0.6;
                
                if (contributedYears > baseYears) {
                    percentage += (contributedYears - baseYears) * 0.02;
                }
                
                percentage = Math.min(percentage, 1.0); // Cap at 100%
                
                return salary * percentage;
            }

            calculateDisabilityValue(salary) {
                // 91% do salário de benefício
                return salary * 0.91;
            }

            calculatePensionValue(salary, dependents) {
                // 50% do salário do falecido + 10% por dependente (até 100%)
                let percentage = 0.5 + (dependents * 0.1);
                percentage = Math.min(percentage, 1.0); // Cap at 100%
                
                return salary * percentage;
            }

            calculateBPCValue() {
                // Valor fixo do BPC (1 salário mínimo)
                return 1412.00; // Valor aproximado do salário mínimo em 2024
            }

            calculateSpecialRetirementValue(salary) {
                // 100% do salário de benefício para aposentadoria especial
                return salary;
            }

            updateResults(results) {
                Object.keys(results).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.textContent = results[key];
                    }
                });
            }

            resetCalculator() {
                // Reset form
                document.getElementById('calculatorForm').reset();
                
                // Reset benefit selection
                document.querySelectorAll('.benefit-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                this.selectedBenefit = null;
                document.getElementById('nextStep1').disabled = true;
                
                // Reset form data
                this.formData = {};
                
                // Hide all special fields
                document.getElementById('specialPeriodsGroup').style.display = 'none';
                document.getElementById('disabilityInfoGroup').style.display = 'none';
                document.getElementById('pensionInfoGroup').style.display = 'none';
                document.getElementById('bpcInfoGroup').style.display = 'none';
                document.getElementById('dependentsGroup').style.display = 'none';
                document.getElementById('detailDependentsItem').style.display = 'none';
                
                // Go back to first step
                this.showStep(1);
                
                // Remove any error messages
                const errorMessages = document.querySelectorAll('.error-message');
                errorMessages.forEach(msg => msg.remove());
            }
        }

        // Initialize calculator when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            new PrevidenciaCalculator();
        });
    </script>

    <style>
        /* Estilos adicionais para a calculadora */
        .benefit-selection {
            margin-bottom: 2rem;
        }

        .benefit-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .benefit-option {
            background: var(--container-color);
            border: 2px solid var(--border-color);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .benefit-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-color);
        }

        .benefit-option.selected {
            border-color: var(--secondary-color);
            background: rgba(212, 175, 55, 0.05);
        }

        .benefit-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .benefit-option h4 {
            margin-bottom: 0.5rem;
            color: var(--primary-color);
        }

        .benefit-option p {
            color: var(--text-light);
            font-size: 0.9rem;
            line-height: 1.4;
        }

        @media screen and (max-width: 768px) {
            .benefit-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</body>
</html>
