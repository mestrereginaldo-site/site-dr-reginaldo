<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Previdência</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* ESTILOS DE EMERGÊNCIA - caso o CSS não carregue */
        .form-step { display: none; }
        .form-step.active { display: block; }
        .button { padding: 10px 20px; background: #d4af37; color: white; border: none; border-radius: 5px; cursor: pointer; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; }
        input, select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
    </style>
</head>
<body>
    <!-- ESTRUTURA SIMPLIFICADA -->
    <header style="background: #1a3c6e; color: white; padding: 1rem 0; position: fixed; width: 100%; top: 0;">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="background: white; color: #1a3c6e; width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-balance-scale"></i>
                    </div>
                    <div>
                        <div style="font-weight: bold;">ADVOCACIA</div>
                        <small>Previdenciária Especializada</small>
                    </div>
                </div>
                <nav>
                    <a href="index.html" style="color: white; margin-left: 20px;">Início</a>
                    <a href="calculadora.html" style="color: #d4af37; margin-left: 20px;">Calculadora</a>
                </nav>
            </div>
        </div>
    </header>

    <main style="margin-top: 80px;">
        <!-- Calculator Hero -->
        <section style="background: linear-gradient(135deg, #1a3c6e 0%, #0f2647 100%); color: white; padding: 4rem 0; text-align: center;">
            <div class="container">
                <h1>Calculadora de Previdência</h1>
                <p>Simule sua aposentadoria</p>
            </div>
        </section>

        <!-- Calculator -->
        <section style="padding: 2rem 0;">
            <div class="container">
                <div style="max-width: 600px; margin: 0 auto; background: white; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); padding: 2rem;">
                    
                    <!-- Steps -->
                    <div style="display: flex; justify-content: space-between; margin-bottom: 2rem; background: #f8f9fa; padding: 1rem; border-radius: 10px;">
                        <div style="text-align: center; flex: 1;">
                            <div style="background: #d4af37; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 5px;">1</div>
                            <div>Dados Pessoais</div>
                        </div>
                        <div style="text-align: center; flex: 1;">
                            <div style="background: #ccc; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 5px;">2</div>
                            <div>Profissional</div>
                        </div>
                        <div style="text-align: center; flex: 1;">
                            <div style="background: #ccc; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 5px;">3</div>
                            <div>Resultado</div>
                        </div>
                    </div>

                    <!-- Form Steps -->
                    <form id="calculatorForm">
                        <!-- Step 1 -->
                        <div class="form-step active" data-step="1">
                            <h3 style="text-align: center; margin-bottom: 1.5rem; color: #1a3c6e;">Dados Pessoais</h3>
                            
                            <div class="form-group">
                                <label for="birthDate">Data de Nascimento *</label>
                                <input type="date" id="birthDate" name="birthDate" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="gender">Gênero *</label>
                                <select id="gender" name="gender" required>
                                    <option value="">Selecione</option>
                                    <option value="male">Masculino</option>
                                    <option value="female">Feminino</option>
                                </select>
                            </div>
                            
                            <div style="text-align: right; margin-top: 2rem;">
                                <button type="button" class="button next-step" data-next="2" style="background: #d4af37; color: white;">
                                    Próximo <i class="fas fa-arrow-right"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Step 2 -->
                        <div class="form-step" data-step="2">
                            <h3 style="text-align: center; margin-bottom: 1.5rem; color: #1a3c6e;">Informações Profissionais</h3>
                            
                            <div class="form-group">
                                <label for="startWork">Data de Início *</label>
                                <input type="date" id="startWork" name="startWork" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="salary">Salário Base (R$) *</label>
                                <input type="number" id="salary" name="salary" min="1300" max="7500" required placeholder="Ex: 3000">
                            </div>
                            
                            <div class="form-group">
                                <label for="contributionType">Tipo de Contribuição *</label>
                                <select id="contributionType" name="contributionType" required>
                                    <option value="">Selecione</option>
                                    <option value="age">Por Idade</option>
                                    <option value="time">Por Tempo</option>
                                    <option value="mixed">Regra de Transição</option>
                                </select>
                            </div>
                            
                            <div style="display: flex; justify-content: space-between; margin-top: 2rem;">
                                <button type="button" class="button prev-step" data-prev="1" style="background: #6c757d; color: white;">
                                    <i class="fas fa-arrow-left"></i> Anterior
                                </button>
                                <button type="button" class="button calculate-btn" style="background: #d4af37; color: white;">
                                    Calcular <i class="fas fa-calculator"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Step 3 -->
                        <div class="form-step" data-step="3">
                            <h3 style="text-align: center; margin-bottom: 1.5rem; color: #1a3c6e;">Resultado</h3>
                            
                            <div id="results" style="background: #f8f9fa; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;">
                                <div style="text-align: center;">
                                    <h4 style="color: #1a3c6e;">Sua simulação está pronta!</h4>
                                    <p>Preencha os dados para ver o resultado</p>
                                </div>
                            </div>
                            
                            <div style="display: flex; justify-content: space-between; margin-top: 2rem;">
                                <button type="button" class="button prev-step" data-prev="2" style="background: #6c757d; color: white;">
                                    <i class="fas fa-arrow-left"></i> Voltar
                                </button>
                                <button type="button" class="button new-calculation" style="background: #d4af37; color: white;">
                                    <i class="fas fa-redo"></i> Nova Simulação
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <script>
        // CALCULADORA SIMPLIFICADA - 100% FUNCIONAL
        class PrevidenciaCalculator {
            constructor() {
                this.currentStep = 1;
                this.formData = {};
                this.init();
            }

            init() {
                this.bindEvents();
                this.showStep(1);
            }

            bindEvents() {
                // Botões Próximo
                document.querySelectorAll('.next-step').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const nextStep = parseInt(e.target.getAttribute('data-next'));
                        if (this.validateStep(this.currentStep)) {
                            this.saveStepData(this.currentStep);
                            this.showStep(nextStep);
                        }
                    });
                });

                // Botões Anterior
                document.querySelectorAll('.prev-step').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const prevStep = parseInt(e.target.getAttribute('data-prev'));
                        this.showStep(prevStep);
                    });
                });

                // Calcular
                document.querySelector('.calculate-btn').addEventListener('click', () => {
                    if (this.validateStep(2)) {
                        this.saveStepData(2);
                        this.calculate();
                        this.showStep(3);
                    }
                });

                // Nova simulação
                document.querySelector('.new-calculation').addEventListener('click', () => {
                    this.resetCalculator();
                });
            }

            showStep(step) {
                // Esconder todos os passos
                document.querySelectorAll('.form-step').forEach(stepEl => {
                    stepEl.classList.remove('active');
                });

                // Mostrar passo atual
                document.querySelector(`.form-step[data-step="${step}"]`).classList.add('active');

                // Atualizar indicador de passos
                document.querySelectorAll('.calculator-steps .step').forEach(stepEl => {
                    stepEl.classList.remove('active');
                });

                this.currentStep = step;
            }

            validateStep(step) {
                let isValid = true;
                const currentStepEl = document.querySelector(`.form-step[data-step="${step}"]`);
                const inputs = currentStepEl.querySelectorAll('input[required], select[required]');

                inputs.forEach(input => {
                    if (!input.value) {
                        input.style.borderColor = 'red';
                        isValid = false;
                    } else {
                        input.style.borderColor = '';
                    }
                });

                if (!isValid) {
                    alert('Preencha todos os campos obrigatórios!');
                }

                return isValid;
            }

            saveStepData(step) {
                const stepEl = document.querySelector(`.form-step[data-step="${step}"]`);
                const inputs = stepEl.querySelectorAll('input, select');
                
                inputs.forEach(input => {
                    this.formData[input.name] = input.value;
                });
            }

            calculate() {
                const birthDate = new Date(this.formData.birthDate);
                const startWork = new Date(this.formData.startWork);
                const salary = parseFloat(this.formData.salary);
                const gender = this.formData.gender;
                const contributionType = this.formData.contributionType;

                const today = new Date();
                const currentAge = this.calculateAge(birthDate, today);
                const contributedTime = this.calculateTimeDifference(startWork, today);

                let resultAge, resultTimeLeft, resultValue, detailRule;

                // Cálculos
                switch (contributionType) {
                    case 'age':
                        resultAge = gender === 'male' ? 65 : 62;
                        resultTimeLeft = Math.max(0, resultAge - currentAge);
                        resultValue = salary * 0.7;
                        detailRule = 'Aposentadoria por Idade';
                        break;

                    case 'time':
                        const requiredTime = gender === 'male' ? 40 : 35;
                        resultAge = currentAge + Math.max(0, requiredTime - contributedTime.years);
                        resultTimeLeft = Math.max(0, requiredTime - contributedTime.years);
                        resultValue = salary * 0.8;
                        detailRule = 'Aposentadoria por Tempo';
                        break;

                    case 'mixed':
                        resultAge = gender === 'male' ? 65 : 62;
                        resultTimeLeft = Math.max(0, resultAge - currentAge);
                        resultValue = salary * 0.75;
                        detailRule = 'Regra de Transição';
                        break;
                }

                // Mostrar resultados
                const resultsHTML = `
                    <div style="text-align: center;">
                        <div style="background: #d4af37; color: white; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                            <h4>Idade para Aposentadoria</h4>
                            <div style="font-size: 1.5rem; font-weight: bold;">${resultAge} anos</div>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div style="background: #e9ecef; padding: 1rem; border-radius: 8px;">
                                <h4>Tempo Restante</h4>
                                <div style="font-weight: bold;">${resultTimeLeft} anos</div>
                            </div>
                            <div style="background: #e9ecef; padding: 1rem; border-radius: 8px;">
                                <h4>Valor Estimado</h4>
                                <div style="font-weight: bold;">R$ ${resultValue.toFixed(2)}</div>
                            </div>
                        </div>
                        <div style="margin-top: 1rem; padding: 1rem; background: #d1ecf1; border-radius: 8px;">
                            <strong>Regra:</strong> ${detailRule}<br>
                            <strong>Idade Atual:</strong> ${currentAge} anos<br>
                            <strong>Tempo Contribuído:</strong> ${contributedTime.years} anos
                        </div>
                    </div>
                `;

                document.getElementById('results').innerHTML = resultsHTML;
            }

            calculateAge(birthDate, currentDate) {
                let age = currentDate.getFullYear() - birthDate.getFullYear();
                const monthDiff = currentDate.getMonth() - birthDate.getMonth();
                
                if (monthDiff < 0 || (monthDiff === 0 && currentDate.getDate() < birthDate.getDate())) {
                    age--;
                }
                
                return age;
            }

            calculateTimeDifference(startDate, endDate) {
                let years = endDate.getFullYear() - startDate.getFullYear();
                let months = endDate.getMonth() - startDate.getMonth();
                
                if (months < 0) {
                    years--;
                    months += 12;
                }
                
                return { years, months };
            }

            resetCalculator() {
                document.getElementById('calculatorForm').reset();
                this.formData = {};
                this.showStep(1);
                document.getElementById('results').innerHTML = `
                    <div style="text-align: center;">
                        <h4 style="color: #1a3c6e;">Sua simulação está pronta!</h4>
                        <p>Preencha os dados para ver o resultado</p>
                    </div>
                `;
            }
        }

        // Inicializar quando a página carregar
        document.addEventListener('DOMContentLoaded', function() {
            new PrevidenciaCalculator();
        });
    </script>
</body>
</html>
